{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./resources/common/colorblind.js"],"names":["ColorMatrixMatrixes","Normal","R","G","B","Protanopia","Protanomaly","Deuteranopia","Deuteranomaly","Tritanopia","Tritanomaly","Achromatopsia","Achromatomaly","imageCache","urlCache","colorMatrixFilterFunctions","r","rgb","g","b","matrix","matrixFunction","lib","type","getFilteredImage","filterFunction","getFilterFunction","canvas","document","w","img","h","scale","containerWidth","ratio","window","ctx","pixels","i","filteredRGB","url"],"mappings":"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","file":"resources_common_colorblind.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./resources/common/colorblind.js\");\n","// Source: http://web.archive.org/web/20081014161121/http://www.colorjack.com/labs/colormatrix/\n// Another Source: https://www.reddit.com/r/gamedev/comments/2i9edg/code_to_create_filters_for_colorblind/\n//\n/* Comment on http://kaioa.com/node/75#comment-247 states that:\n\nColorMatrix? Nope, won't work.\nYou're right, the ColorMatrix version is very simplified, and not accurate. I created that color matrix one night (http://www.colorjack.com/labs/colormatrix/)\nand since then it's shown up many places... I should probably take that page down before it spreads more! Anyways, it gives you an idea of what it might look\nlike, but for the real thing...\n\nAs far as a simple script to simulate color blindness, this one does the best job:\n\nhttp://www.nofunc.com/Color_Blindness_Library/ — It uses \"confusion lines\" within the XYZ color space to calculate values (this one is in Javascript, and should be easy to convert to python).\n\nThere are a few other methods, and no one really knows exactly what it would look like... these are all generalizations of a small sample, set against the masses.\n*/\nconst ColorMatrixMatrixes = {\n\tNormal: {\n\t\tR: [100, 0, 0],\n\t\tG: [0, 100, 0],\n\t\tB: [0, 0, 100/*Fixed: was in the wrong spot in the original version*/]\n\t},\n\tProtanopia: {\n\t\tR: [56.667, 43.333, 0],\n\t\tG: [55.833, 44.167, 0],\n\t\tB: [0, 24.167, 75.833]\n\t},\n\tProtanomaly: {\n\t\tR: [81.667, 18.333, 0],\n\t\tG: [33.333, 66.667, 0],\n\t\tB: [0, 12.5, 87.5]\n\t},\n\tDeuteranopia: {\n\t\tR: [62.5, 37.5, 0],\n\t\tG: [70, 30, 0],\n\t\tB: [0, 30, 70]\n\t},\n\tDeuteranomaly: {\n\t\tR: [80, 20, 0],\n\t\tG: [25.833, 74.167, 0],\n\t\tB: [0, 14.167, 85.833]\n\t},\n\tTritanopia: {\n\t\tR: [95, 5, 0],\n\t\tG: [0, 43.333, 56.667],\n\t\tB: [0, 47.5, 52.5]\n\t},\n\tTritanomaly: {\n\t\tR: [96.667, 3.333, 0],\n\t\tG: [0, 73.333, 26.667],\n\t\tB: [0, 18.333, 81.667]\n\t},\n\tAchromatopsia: {\n\t\tR: [29.9, 58.7, 11.4],\n\t\tG: [29.9, 58.7, 11.4],\n\t\tB: [29.9, 58.7, 11.4]\n\t},\n\tAchromatomaly: {\n\t\tR: [61.8, 32, 6.2],\n\t\tG: [16.3, 77.5, 6.2],\n\t\tB: [16.3, 32.0, 51.6]\n\t}\n};\n\nconst imageCache = {}, urlCache = {}, colorMatrixFilterFunctions = {};\n\nfunction matrixFunction(matrix) {\n\treturn function (rgb) {\n\t\tvar r = rgb[0];\n\t\tvar g = rgb[1];\n\t\tvar b = rgb[2];\n\t\treturn [\n\t\t\tr * matrix.R[0] / 100.0 + g * matrix.R[1] / 100.0 + b * matrix.R[2] / 100.0,\n\t\t\tr * matrix.G[0] / 100.0 + g * matrix.G[1] / 100.0 + b * matrix.G[2] / 100.0,\n\t\t\tr * matrix.B[0] / 100.0 + g * matrix.B[1] / 100.0 + b * matrix.B[2] / 100.0\n\t\t];\n\t};\n}\n\nfor (let t in ColorMatrixMatrixes) {\n\tif (ColorMatrixMatrixes.hasOwnProperty(t)) {\n\t\tcolorMatrixFilterFunctions[t] = matrixFunction(ColorMatrixMatrixes[t]);\n\t}\n}\n\nfunction getFilterFunction(type) {\n\tconst lib = colorMatrixFilterFunctions;\n\ttype = type.substring(5);\n\tif (type in lib) {\n\t\treturn lib[type];\n\t} else {\n\t\tthrow 'Library does not support Filter Type: ' + type;\n\t}\n}\n\nexport const getFilteredImage = (img, type, containerWidth) => {\n\tconst filterFunction = getFilterFunction(type);\n\tconst canvas = document.createElement('canvas');\n\tconst w = img.naturalWidth, h = img.naturalHeight;\n\t\n\tconst scale = containerWidth / w;\n\tif (scale > 1) {\n\t\tscale = 1;\n\t}\n\n\t// 要设置 canvas 的画布大小，使用的是canvas.width和 canvas.height；\n  // 要设置画布的实际渲染大小，使用的 style 属性或 CSS 设置的 width 和height，只是简单的对画布进行缩放。\n\t// <canvas width=\"640\" height=\"800\" style=\"width:320px; height:400px\"></canvas>\n\tconst ratio = window.devicePixelRatio;\n\t\n\tcanvas.style.width = w * scale;\n\tcanvas.style.height = h * scale;\n \n\tcanvas.width = w * scale * ratio;\n\tcanvas.height = h * scale * ratio;\n\n\tconst ctx = canvas.getContext('2d');\n\tctx.drawImage(img, 0, 0, w * scale * ratio, h * scale * ratio);\n\t\n\tconst pixels = ctx.getImageData(0, 0,  w * scale * ratio, h * scale * ratio);\n\n\tfor (let i = 0; i < pixels.data.length; i += 4) {\n\t\tconst rgb = [pixels.data[i], pixels.data[i + 1], pixels.data[i + 2]];\n\t\tconst filteredRGB = filterFunction(rgb);\n\t\tpixels.data[i] = filteredRGB[0];\n\t\tpixels.data[i + 1] = filteredRGB[1];\n\t\tpixels.data[i + 2] = filteredRGB[2];\n\t}\n\tctx.putImageData(pixels, 0, 0);\n\tconst url = canvas.toDataURL();\n\treturn url\n}\n\n"],"sourceRoot":""}